library(shiny)
library(shinythemes)
library(ggplot2)

ui <- fluidPage( theme = shinytheme("flatly"),
        

     fluidRow( column (verticalLayout( 
         
                  wellPanel("We will aproximate Pi by generating random points
                  in a square and then counting what fraction of those
                  points are inside the circle contained in the square.
                  You can think of this as randomly throwing darts at a square board.
                  Since we know what the area of a square is we've 
                  replaced a calculus problem with a counting problem! Play around with the slider on the
                  right - you should get a better approximation of Pi the more points you use."),
                      
                  wellPanel(sliderInput(inputId = "num",
                    label = "Number of Points",
                    value = 1000, min = 10, max = 30000)),
                
                  wellPanel("Your approximation of pi is:",
                    verbatimTextOutput("pi"))) , width = 3),
                       
     
         column(plotOutput("plot", width = "700px", height = "700px"), 
                  width = 8)
        )
     )


server <- function(input, output) {
    
    dat <- function(num){
        x <- replicate(2, runif(num ,min = -1, max = 1))
        inside <- (apply(x, 1, function(x) {x[1]^2 +x[2]^2}))<=1
        data.frame(x, inside)
    }
    
    rv <- reactive({dat(input$num)})
    
    output$pi <- renderPrint({
        
        4 *sum(rv()$inside)/input$num
    })
    
    output$plot <- renderPlot({
        
        qplot(rv()[,1], rv()[,2], data = rv(),color = inside, xlab = "x", ylab = "y") +
                     scale_color_brewer(palette = "Set1") +
                     theme_minimal() +
                     theme(legend.position="none")  
    })
    }

shinyApp(ui = ui, server = server)
